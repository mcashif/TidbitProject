<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
	<head>
	
	  <title>Welcome|Tidbit</title>
	  <meta charset="utf-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1">
	  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>	  
	  <link rel='stylesheet prefetch' href='//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css'>
		
	</head>
	
	
	
<body>

<div class="container">
  <h1>EDIT TIDBIT</h1>

  <div id="table" class="table-editable">
    <span class="table-add glyphicon glyphicon-plus"></span>
    <table class="table">
  	 <tr>
  	  					<th>Sheet Name</th>
					    <th>Cell Name</th>
					    <th>Value</th>
					    <th>Top Label</th>
					    <th>Left Label</th>
					    <th>Formula</th>
					    <th></th>
					    <th></th>
					    <th></th>
					    <th></th>
					    <th></th>
					    <th></th>
	  </tr>
	  
	  
	  {% for data in listofdData %}
      <tr>
      	            
  
        
        {% if data.0 == 1 %}
	        <td contenteditable="true">{{data.1}}</td>
	        <td contenteditable="true">{{data.2}}</td>
	        <td contenteditable="true">{{data.4}}</td>
	        <td contenteditable="true">{{data.5}}</td>
	        <td contenteditable="true">{{data.6}}</td>
	        <td contenteditable="true">{{data.3}}</td>
        {% endif %}
        
        {% if data.0 == 0 %}
	        <td contenteditable="true">{{data.1}}</td>
	        <td contenteditable="true">{{data.2}}</td>
	        <td contenteditable="true">{{data.3}}</td>
	        <td contenteditable="true">{{data.4}}</td>
	        <td contenteditable="true">{{data.5}}</td>
	         <td contenteditable="true">No Formula</td>
        {% endif %}
        
        <td>
          <span class="table-remove glyphicon glyphicon-remove"></span>
        </td>
        <td>
          <span class="table-up glyphicon glyphicon-arrow-up"></span>
          <span class="table-down glyphicon glyphicon-arrow-down"></span>
        </td>
      </tr>
      {% endfor %}
      
      <!-- This is our clonable table line -->
      <tr class="hide">
        <td contenteditable="true">Untitled</td>
        <td contenteditable="true">Untitled</td>
        <td contenteditable="true">undefined</td>
        <td contenteditable="true">Untitled</td>
        <td contenteditable="true">undefined</td>
        <td contenteditable="true">Untitled</td>
        <td>
          <span class="table-remove glyphicon glyphicon-remove"></span>
        </td>
        <td>
          <span class="table-up glyphicon glyphicon-arrow-up"></span>
          <span class="table-down glyphicon glyphicon-arrow-down"></span>
        </td>
      </tr>
    </table>
  </div>
  
  <button id="export-btn" class="btn btn-primary">Export Data</button>
  <p id="export"></p>
</div>

		<style class="cp-pen-styles">.table-editable {
		  position: relative;
		}
		.table-editable .glyphicon {
		  font-size: 20px;
		}
		
		.table-remove {
		  color: #700;
		  cursor: pointer;
		}
		.table-remove:hover {
		  color: #f00;
		}
		
		.table-up, .table-down {
		  color: #007;
		  cursor: pointer;
		}
		.table-up:hover, .table-down:hover {
		  color: #00f;
		}
		
		.table-add {
		  color: #070;
		  cursor: pointer;
		  position: absolute;
		  top: 8px;
		  right: 0;
		}
		.table-add:hover {
		  color: #0b0;
		}
		</style>
		
		<script>
		
			var $TABLE = $('#table');
			var $BTN = $('#export-btn');
			var $EXPORT = $('#export');
			
			$('.table-add').click(function () {
			    var $clone = $TABLE.find('tr.hide').clone(true).removeClass('hide table-line');
			    $TABLE.find('table').append($clone);
			});
			$('.table-remove').click(function () {
			    $(this).parents('tr').detach();
			});
			$('.table-up').click(function () {
			    var $row = $(this).parents('tr');
			    if ($row.index() === 1)
			        return;
			    $row.prev().before($row.get(0));
			});
			$('.table-down').click(function () {
			    var $row = $(this).parents('tr');
			    $row.next().after($row.get(0));
			});
			jQuery.fn.pop = [].pop;
			jQuery.fn.shift = [].shift;
			$BTN.click(function () {
			    var $rows = $TABLE.find('tr:not(:hidden)');
			    var headers = [];
			    var data = [];
			    $($rows.shift()).find('th:not(:empty)').each(function () {
			        headers.push($(this).text().toLowerCase());
			    });
			    $rows.each(function () {
			        var $td = $(this).find('td');
			        var h = {};
			        headers.forEach(function (header, i) {
			            h[header] = $td.eq(i).text();
			        });
			        data.push(h);
			    });
			    $EXPORT.text(JSON.stringify(data));
			});
			//# sourceURL=pen.js
			</script>
</body>
</html>


			
			